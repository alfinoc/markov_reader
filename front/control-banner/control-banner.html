<link rel="import" href="../bower_components/paper-shadow/paper-shadow.html">
<link rel="import" href="../bower_components/paper-radio-group/paper-radio-group.html">
<link rel="import" href="../icons/icons.html">

<polymer-element name="control-banner" class="dark">
   <template>
      <link rel="stylesheet" type="text/css" href="banner.css">
      <link rel="stylesheet" type="text/css" href="control-banner.css">
      <div horizontal layout class="banner">
         <a href="../api.html">
            <circle-dot-icon></circle-dot-icon>
         </a>
         <div flex></div>
         <div class="textbutton" on-click="{{ toggleSourceMenu }}">Sources</div>
         <div flex></div>
         <div class="textbutton">Seed</div>
         <div flex></div>
         <div class="textbutton">Frequency</div>
         <div flex></div>
         <pause-icon on-click="{{ pause }}"></pause-icon>
         <play-icon on-click="{{ play }}"></play-icon>
         <paper-shadow z="1"></paper-shadow>
      </div>
      <div id="sources" class="banner menu">
         <paper-radio-group horizontal layout multi selected="{{ selectedSources }}">
            <template repeat="{{ s in sources | dictToList }}">
               <paper-radio-button flex toggles name="{{ s.value }}" label="{{ s.key }}">
               </paper-radio-button>
            </template>
         </paper-radio-group>
         <paper-shadow z="1"></paper-shadow>
      </div>
   </template>
   <script>

Polymer('control-banner', {
   publish: {
      playing: {
         value: true,
         reflect: true
      },
      // Map from source display name to key.
      sources: {
         'Wuthering Heights': 'wutheringheights.txt',
         'Dracula': 'dracula.txt'
      },
      // List of source keys that are selected.
      selectedSources: {
         value: [],
         reflect: true
      }
   },

   toggleSourceMenu: function() {
      this.toggleMenu(this.$.sources);
   },

   toggleMenu: function(elem) {
      if (elem.classList.contains('hide')) {
         this.querySelectorAll('.menu:not(.hide)').array().forEach(function(shown) {
            this.hide(shown);
         }.bind(this));
         this.show(elem);
      } else {
         this.hide(elem);
      }
   },

   hide: function(elem) {
      elem.classList.add('hide');
   },

   show: function(elem) {
      elem.classList.remove('hide');
   },

   dictToList: function(dict) {
      var res = [];
      for (key in dict)
         res.push({ 'key': key, 'value': dict[key]});
      return res;
   },

   play: function() {
      this.fire('play');
   },

   pause: function() {
      this.fire('pause');
   }
});

   </script>
</polymer-element>
